<!DOCTYPE html>
<html>
<head>
    <title>Ultrasonic Sensor Dashboard</title>
    <style>
        body { font-family: Arial; text-align: center; margin-top: 50px; }
        h1 { color: #333; }
        #distance { font-size: 2em; color: #007BFF; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Ultrasonic Sensor Distance</h1>
    <p>Current Distance:</p>
    <div id="distance">-- cm</div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <script>
        // TODO: Replace these with your Firebase project values
        const firebaseConfig = {
            apiKey: "AIzaSyDfXfe72XomxYj7coWith7PK48Mi2lCUdc",
            authDomain: "dht12-59008.firebaseapp.com",
            databaseURL: "https://dht12-59008-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "dht12-59008",
            storageBucket: "dht12-59008.firebasestorage.app",
            messagingSenderId: "902371164975",
            appId: "1:902371164975:web:fe4d4b997c09ee9eb317da"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Reference to ultrasonic data
        const ultrasonicRef = db.ref('ultrasonic');

        // Listen for all data and find the latest entry
        ultrasonicRef.on('value', (snapshot) => {
            const val = snapshot.val();
            if(val){
                const keys = Object.keys(val);             // get all timestamp keys
                keys.sort();                               // sort timestamps ascending
                const lastKey = keys[keys.length - 1];    // get latest timestamp
                const distance = val[lastKey].distance;   // get distance value
                if(distance !== undefined){
                    document.getElementById('distance').innerText = distance + " cm";
                } else {
                    document.getElementById('distance').innerText = "No distance value";
                }
            } else {
                document.getElementById('distance').innerText = "No data available";
            }
        }, (error) => {
            console.error("Firebase read failed: ", error);
            document.getElementById('distance').innerText = "Error reading data";
        });
    </script>
</body>
</html>
